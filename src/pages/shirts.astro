---
import BackOnTrackLayout from "../layouts/BackOnTrackLayout.astro";
import PocketBase from "pocketbase";

const pb = new PocketBase("https://pb.backontrackus.org");

let locations = [];
try {
  const records = await pb.collection("locations").getFullList({
    sort: "name",
  });
  locations = records.map(record => record.name);
} catch (error) {
  console.error("Error loading locations:", error);
  locations = ["Other"];
}
---

<BackOnTrackLayout title="Shirts">
  <div
    class="h-full flex-grow bg-black/[.6] bg-[url('/backontrack-group.jpg')] bg-cover bg-fixed bg-center bg-no-repeat bg-blend-overlay"
  >
    <div class="flex flex-col items-center px-4 py-10">
      <h1 class="text-center text-3xl font-bold text-white md:text-4xl mb-2">
        Order Your Shirt
      </h1>
      <h2 class="text-center text-xl text-white md:text-2xl mb-8">
        Get your Back on Track America merch!
      </h2>
      
      <div class="w-full max-w-6xl mx-auto grid grid-cols-1 lg:grid-cols-2 gap-8">
        <div id="shirtPreview" class="order-2 lg:order-1">
          <div class="bg-white rounded-lg shadow-lg p-6 h-fit sticky top-20">
            <h3 class="text-center text-lg font-semibold text-gray-700 mb-4">Shirt Preview</h3>
            <img 
              src="/shirt.jpg"
              alt="Back on Track America Shirt Preview"
              class="w-full h-auto rounded-lg shadow-md"
            />
          </div>
        </div>
        
        <div class="order-1 lg:order-2">
          <div class="bg-white rounded-lg shadow-lg p-8">
        <form id="shirtsForm" class="space-y-6">
          <div>
            <label for="name" class="block text-sm font-semibold text-gray-700 mb-2">
              Name <span class="text-red-500">*</span>
            </label>
            <input
              type="text"
              id="name"
              name="name"
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-bot-blue focus:border-bot-blue transition duration-200"
              placeholder="Enter your full name"
            />
          </div>

          <div>
            <label for="email" class="block text-sm font-semibold text-gray-700 mb-2">
              Email <span class="text-red-500">*</span>
            </label>
            <input
              type="email"
              id="email"
              name="email"
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-bot-blue focus:border-bot-blue transition duration-200"
              placeholder="Enter your email address"
            />
          </div>

          <div>
            <label for="phone" class="block text-sm font-semibold text-gray-700 mb-2">
              Phone <span class="text-red-500">*</span>
            </label>
            <input
              type="tel"
              id="phone"
              name="phone"
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-bot-blue focus:border-bot-blue transition duration-200"
              placeholder="Enter your phone number"
            />
          </div>

          <div>
            <label for="location" class="block text-sm font-semibold text-gray-700 mb-2">
              Location <span class="text-red-500">*</span>
            </label>
            <select
              id="location"
              name="location"
              required
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-bot-blue focus:border-bot-blue transition duration-200 bg-white"
            >
              <option value="">Select your location...</option>
              {locations.map((location) => (
                <option value={location}>{location}</option>
              ))}
            </select>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Size <span class="text-red-500">*</span>
            </label>
            <div class="space-y-2">
              <label class="flex items-center">
                <input
                  type="radio"
                  name="size"
                  value="Small"
                  required
                  class="mr-3 text-bot-blue focus:ring-bot-blue"
                />
                <span>Small</span>
              </label>
              <label class="flex items-center">
                <input
                  type="radio"
                  name="size"
                  value="Medium"
                  required
                  class="mr-3 text-bot-blue focus:ring-bot-blue"
                />
                <span>Medium</span>
              </label>
              <label class="flex items-center">
                <input
                  type="radio"
                  name="size"
                  value="Large"
                  required
                  class="mr-3 text-bot-blue focus:ring-bot-blue"
                />
                <span>Large</span>
              </label>
              <label class="flex items-center">
                <input
                  type="radio"
                  name="size"
                  value="XL"
                  required
                  class="mr-3 text-bot-blue focus:ring-bot-blue"
                />
                <span>XL</span>
              </label>
            </div>
          </div>

          <div>
            <label for="comments" class="block text-sm font-semibold text-gray-700 mb-2">
              Other thoughts or comments
            </label>
            <textarea
              id="comments"
              name="comments"
              rows="3"
              class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-bot-blue focus:border-bot-blue transition duration-200 resize-vertical"
              placeholder="Enter any additional thoughts or comments..."
            ></textarea>
          </div>

          <div>
            <label class="block text-sm font-semibold text-gray-700 mb-2">
              Payment Method - Please only pay after receiving a shirt
            </label>
            <div class="space-y-2">
              <label class="flex items-center">
                <input
                  type="radio"
                  name="paymentMethod"
                  value="Cash"
                  class="mr-3 text-bot-blue focus:ring-bot-blue"
                />
                <span>Cash</span>
              </label>
              <label class="flex items-center">
                <input
                  type="radio"
                  name="paymentMethod"
                  value="Zelle"
                  class="mr-3 text-bot-blue focus:ring-bot-blue"
                />
                <span>Zelle</span>
              </label>
              <div class="flex items-center">
                <input
                  type="radio"
                  name="paymentMethod"
                  value="Other"
                  id="paymentOther"
                  class="mr-3 text-bot-blue focus:ring-bot-blue"
                />
                <span class="mr-2">Other:</span>
                <input
                  type="text"
                  id="paymentOtherText"
                  name="paymentOtherText"
                  class="w-2/3 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-bot-blue focus:border-bot-blue transition duration-200"
                  placeholder="Specify other payment method"
                />
              </div>
            </div>
          </div>

          <div class="flex justify-center pt-4">
            <button
              type="submit"
              class="bg-bot-blue text-white font-bold py-3 px-8 rounded-lg transition duration-200 transform hover:scale-105 focus:ring-4 focus:ring-blue-300 focus:outline-none"
            >
              Place Order
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script src="/js/shirts-form.js" is:inline></script>
</BackOnTrackLayout>
